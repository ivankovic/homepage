<!DOCTYPE HTML>
<html lang="en">
  <head>
    <title>Raspberry Pi swarm - Automatically installing security updates</title>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans|Poiret+One" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://www.ivankovic.me/css/style.css" media="screen">
    <link rel="icon" href="/favicon.ico">
    <meta charset="utf-8">
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">

    <script>
      function toggle() {
        menu = document.getElementById('menu')
        menu.style.display = (menu.style.display == 'none' || menu.style.display == '' ? 'block' : 'none')
      }
    </script>
  </head>
  <body>
    <div
       id="main"
       
    >


<header>
  <nav>
    <a href="/">Ivankovic.Me</a>
    <span id="subpages">
      <a href="/photography/">Photography</a>
      <a href="/blog/" >Blog</a>
      <a href="/contact/" >Contact</a>
      <a href="/about/" >About</a>
    </span>
  </nav>
</header>


<div id="content" style="display: block; padding-left: 64px;" itemscope itemtype="https://schema.org/BlogPosting">
  

<h1 id="raspberry-pi-swarm-automatically-installing-security-updates">Raspberry PI swarm - Automatically installing security updates</h1>

<p>When the security 0-day hits the fan, you want to update as fast as super humanly possible. <a href="http://en.wikipedia.org/wiki/Responsible_disclosure">Responsible disclosure</a> and <a href="http://en.wikipedia.org/wiki/News_embargo">embargos</a> on major security updates are fantastic, but if the last mile is not fast enough, you will be targeted by opportunistic internet wide scans.</p>

<p>Luckily, setting up automatic security updates on Debian is very easy.</p>

<h2 id="required-packages">Required packages</h2>

<p>All you need is <a href="http://en.wikipedia.org/wiki/Anacron">Anacron</a> and unnatended-upgrades. Technically you don’t even need anacron, if you are sure all your machines will run <sup>24</sup>&frasl;<sub>7</sub>.</p>

<p>sudo apt-get install anacron unattended-upgrades</p>

<h2 id="configuration">Configuration</h2>

<p>You probably don’t need to configure Anacron. You do need to configure unattended-upgrades a bit though.</p>

<p>There are two main files you need to touch:</p>

<ol>
<li><code>/etc/apt/apt.conf.d/50unattended-upgrades</code> contains general settings for <code>unattended-upgrades</code>. You probably want to set <code>Unattended-Upgrade::Mail</code> to your email address.</li>

<li><p><code>/etc/apt/apt.conf.d/02periodic</code> you probably need to create from scratch. I recommend the following options:</p>

<pre><code> // Enable the update/upgrade script (0=disable)
 APT::Periodic::Enable &quot;1&quot;;

 // Do &quot;apt-get update&quot; automatically every n-days (0=disable)
 APT::Periodic::Update-Package-Lists &quot;1&quot;;

 // Do &quot;apt-get upgrade --download-only&quot; every n-days (0=disable)
 APT::Periodic::Download-Upgradeable-Packages &quot;1&quot;;

 // Run the &quot;unattended-upgrade&quot; security upgrade script
 // every n-days (0=disabled)
 // Requires the package &quot;unattended-upgrades&quot; and will write
 // a log in /var/log/unattended-upgrades
 APT::Periodic::Unattended-Upgrade &quot;1&quot;;

 // Do &quot;apt-get autoclean&quot; every n-days (0=disable)
 APT::Periodic::AutocleanInterval &quot;7&quot;;
 Testing it out
</code></pre></li>
</ol>

<p>You can run <code>unattended-upgrades</code> by hand and check the log, by default located at <code>/var/log/unattended-upgrades/unattended-upgrades.log</code>.</p>

<p>You can try out Anacron by running <code>anacron -f -n -s -d</code>.</p>

</div>

    </div>
  </body>
</html>


<!doctype html><html lang=hr><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><title>Sinkronizacija MikroTik Vatrozid Filtera</title>
<link rel="shortcut icon" href=/favicon.ico type=image/ico><link rel=apple-touch-icon href=/app-icon.png><link rel=canonical href=http://localhost:1313/hr/marko/blog/mikrotik-sync-firewall-rules-script/><link rel=alternate type=application/rss+xml href=http://localhost:1313//index.xml title="Ivankovic Family Website"><meta name=description content="Skripta za sinkronizaciju filtera. Pogodna za CAPsMAN."><meta name=keywords content="MikroTik ,CAPsMAN ,sinkronizacija vatrozid pravila ,MikroTik skripta"><link rel=preload as=font href=/fonts/Sora.ttf type=font/ttf crossorigin><link crossorigin=anonymous integrity="sha256-32IPVFGeVqwZ3oD1TMToMq3r6ySxkcRpkGIqpvYF/xo=" rel=stylesheet href=/css/bundle.min.df620f54519e56ac19de80f54cc4e832adebeb24b191c46990622aa6f605ff1a.css><meta name=twitter:card content="summary"><meta name=twitter:title content="Sinkronizacija MikroTik Vatrozid Filtera"><meta name=twitter:description content="Skripta za sinkronizaciju filtera. Pogodna za CAPsMAN."><meta property="og:url" content="http://localhost:1313/hr/marko/blog/mikrotik-sync-firewall-rules-script/"><meta property="og:site_name" content="Ivankovic Family Website"><meta property="og:title" content="Sinkronizacija MikroTik Vatrozid Filtera"><meta property="og:description" content="Skripta za sinkronizaciju filtera. Pogodna za CAPsMAN."><meta property="og:locale" content="hr"><meta property="og:type" content="article"><meta property="article:section" content="marko"><meta property="article:published_time" content="2025-03-06T00:00:00+00:00"><meta property="article:modified_time" content="2025-03-06T00:00:00+00:00"></head><body><header><nav><div class=menu><a href=http://localhost:1313/hr/marina>Marina Čelar Ivanković</a>
<a href=http://localhost:1313/hr/marko>Marko Ivanković</a>
<a class=call-to-action href=http://localhost:1313/hr/contact>Kontakt</a></div><div class=languages><a href=http://localhost:1313/de/marko/blog/mikrotik-sync-firewall-rules-script/>🇨🇭
</a><a href=http://localhost:1313/marko/blog/mikrotik-sync-firewall-rules-script/>🇬🇧
</a><a href=http://localhost:1313/hr/marko/blog/mikrotik-sync-firewall-rules-script/>🇭🇷</a></div></nav></header><div id=main class=page><div id=content><div id=blog-headline><div id=blog-title><h1>Sinkronizacija MikroTik Vatrozid Filtera</h1></div><div>Jedna minuta za čitanje</div><div>Podijeli na:
<a href="https://bsky.app/intent/compose?text=I am reading http%3a%2f%2flocalhost%3a1313%2fhr%2fmarko%2fblog%2fmikrotik-sync-firewall-rules-script%2f" rel="noopener noreferrer">Bluesky</a>
<a href="https://www.linkedin.com/feed/?shareActive=true&text=I am reading http%3a%2f%2flocalhost%3a1313%2fhr%2fmarko%2fblog%2fmikrotik-sync-firewall-rules-script%2f" target=_blank rel="noopener noreferrer">Linkedin</a>
<a href="https://twitter.com/intent/tweet?text=&url=http%3a%2f%2flocalhost%3a1313%2fhr%2fmarko%2fblog%2fmikrotik-sync-firewall-rules-script%2f)" rel="noopener noreferrer">Twitter</a></div></div><h2 id=problem>Problem</h2><p>Imate jedan glavni MikroTik router. Želite sinkronizirati pravila vatrozida s glavnog routera na sve susjedne uređaje.</p><p>Ovo je često slučaj kada imate CAPsMAN na središnjem routeru i nekoliko CAP pristupnih točaka, jer CAPsMAN ne sinkronizira vatrozid pravila.</p><h2 id=skripta>Skripta</h2><p><strong>Morate</strong> imati omogućenu <a href=https://help.mikrotik.com/docs/spaces/ROS/pages/132350014/SSH#SSH-EnablingPKIauthentication>SSH autentifikaciju javnim ključem</a>.</p><p>Evo skripte:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>:put <span class=s2>&#34;Spremanje trenutnih vatrozid filtera...&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/ip firewall filter <span class=nb>export</span> <span class=nv>file</span><span class=o>=</span>filterRules
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>:local cpes <span class=o>[</span>/ip neighbor print as-value<span class=o>]</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>:foreach cpe <span class=nv>in</span><span class=o>=</span><span class=nv>$cpes</span> <span class=k>do</span><span class=o>={</span>
</span></span><span class=line><span class=cl>    :put <span class=o>((</span><span class=nv>$cpe</span>-&gt;<span class=s2>&#34;address&#34;</span><span class=o>)</span> . <span class=s2>&#34; &#34;</span> . <span class=nv>$cpe</span>-&gt;<span class=s2>&#34;identity&#34;</span><span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    /tool fetch <span class=nv>upload</span><span class=o>=</span>yes <span class=nv>mode</span><span class=o>=</span>ftp <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>        <span class=nv>user</span><span class=o>=</span><span class=s2>&#34;admin&#34;</span> <span class=nv>password</span><span class=o>=</span><span class=s2>&#34;PASSWORD&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>        src-path<span class=o>=</span>filterRules.rsc dst-path<span class=o>=</span>filterRules.rsc <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>        <span class=nv>address</span><span class=o>=(</span><span class=nv>$cpe</span>-&gt;<span class=s2>&#34;address&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    /system ssh-exec <span class=nv>user</span><span class=o>=</span><span class=s2>&#34;admin&#34;</span> <span class=nv>address</span><span class=o>=(</span><span class=nv>$cpe</span>-&gt;<span class=s2>&#34;address&#34;</span><span class=o>)</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>        <span class=nv>command</span><span class=o>=</span><span class=s2>&#34;/ip firewall filter remove [find dynamic=no]; import filterRules.rsc; /file remove filterRules.rsc;&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>:put <span class=s2>&#34;Sinkronizacija vatrozida završena!&#34;</span>
</span></span></code></pre></div><p>Ova skripta prvo briše sva ručno dodana pravila na cAP-ovima, pa to imajte na umu. Osigurat će da su pravila <strong>točno</strong> ista. Sve promjene koje napravite nakon toga bit će izbrisane ako ponovno pokrenete skriptu.</p></div></div><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/hr/>Ivankovic Family Website</a> |
<a href=http://localhost:1313/hr/disclaimer rel="noopener noreferrer" target=_blank>Odricanje od odgovornosti</a> |
<a href=http://localhost:1313/hr/privacy rel="noopener noreferrer" target=_blank>Pravila o zaštiti podataka</a> |
<a href=http://localhost:1313/hr/impressum rel="noopener noreferrer" target=_blank>Impressum</a></span></footer></body></html>